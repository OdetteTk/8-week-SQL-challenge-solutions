
### QUESTION 1

--What is the total amount each customer spent at the restaurant?

````
SELECT customer_id, SUM(price) AS total_$_spent
FROM sales
LEFT JOIN menu
ON sales.product_id = menu.product_id
GROUP BY customer_id
ORDER BY total_$_spent DESC;
````

#### ANSWER

| customer_id | total_$_spent |
| ----------- + --------------|
| A           | 76            |
| B           | 74            |
| C           | 36            |

***

### QUESTION 2

--How many days has each customer visited the restaurant?

````
SELECT customer_id, COUNT(DISTINCT (order_date)) AS number_of_visits
FROM sales
GROUP BY customer_id;
````

### ANSWER

| customer_id | number_of_visits |
| ----------- + ---------------- |
| A           | 4                |
| B           | 6                |
| C           | 2                |


### QUESTION 3

--What was the first item from the menu purchased by each customer?

````
WITH first_purchase AS (
	SELECT s.customer_id, s.order_date, m.product_name,
	DENSE_RANK () OVER (PARTITION BY s.customer_id ORDER BY s.order_date) AS first_order
	FROM sales s
	LEFT JOIN menu m
		ON s.product_id = m.product_id
	GROUP BY s.customer_id, s.order_date, m.product_name
	)
SELECT customer_id, product_name
FROM first_purchase
WHERE first_order = 1;
````

#### ANSWER

| customer_id | product_name |
| ----------- + ------------ |
| A           | curry        |
| A           | sushi        |
| B           | curry        |
| C           | ramen        |


### QUESTION 4

--What is the most purchased item on the menu and how many times was it purchased by all customers?

````
SELECT DISTINCT product_name, COUNT(sales.product_id)
FROM sales
LEFT JOIN menu
ON sales.product_id = menu.product_id
GROUP BY product_name
ORDER BY count DESC
LIMIT 1;
````

### ANSWER

|product_name | count |
| ----------- + ----- |
|ramen        | 8     |


### QUESTION 5

--Which item was the most popular for each customer?

````
WITH product_rank AS(
	SELECT customer_id, product_name, COUNT(sales.product_id) AS most_popular,
	DENSE_RANK () OVER (PARTITION BY customer_id ORDER BY COUNT(sales.product_id) DESC) AS rank
	FROM sales
	LEFT JOIN menu
	ON sales.product_id = menu.product_id
	GROUP BY product_name, customer_id
	)
SELECT customer_id, product_name, rank, most_popular
FROM product_rank
WHERE rank = 1;
````

### ANSWER

| customer_id | product_name | most_popular |
| ----------- + ------------ + ------------ |
|A            |	ramen	       |	3           |
|B	          | ramen	       |	2           |
|B            |	sushi      	 |	2           |
|B           	| curry      	 |	2           |
|C            |	ramen        |	3           |


####QUESTION 6

